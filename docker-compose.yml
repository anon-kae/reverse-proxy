version: '3.7'
services:
  nginx:
    image: nginx:latest
    volumes:
      - ./setup_certbot.sh:/usr/local/bin/setup_certbot.sh
      - ./default.conf.template:/etc/nginx/conf.d/default.conf.template
    environment:
      - DOMAIN=alphaalpaca.xyz
      - BACKEND_SERVICE=http://app:5000
    ports:
      - "80:80"
    entrypoint: /usr/local/bin/setup_certbot.sh
    command: nginx -g "daemon off;"
  app:
    image: web_api_smart_locker
    ports:
      - "5000:5000"
